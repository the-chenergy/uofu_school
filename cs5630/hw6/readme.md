# CS-5630 / CS-6630 Homework 6
*Due: Friday, October 23, 11:59 pm.*

In this assignment, you will build an interactive visualization to explore the political polarity of words used in US governors' state of the state addresses. The visualization is inspired by the NY Times visualization of [corporate tax rates](https://archive.nytimes.com/www.nytimes.com/interactive/2013/05/25/sunday-review/corporate-taxes.html) we discussed in lecture.

We've retrieved the data from [538's public data repositories](https://github.com/fivethirtyeight/data/blob/master/state-of-the-state/words.csv).

## Visualization Design


![Overview](figs/overview.gif)

## Learning Goals
* We're not providing code stubs for this homework; so one of the learning goals is to explore how to implement such a visualization from scratch. 
* You'll learn how to use brushes in D3. 
* You'll see how to implement a basic storytelling feature. 
* Otherwise, most of what you will implementing is already familiar, so we hope that you can consolidate your knowledge. 
* If you're implementing the hacker challenge, you will also learn about force layouts. 

[Here](assets/demo.mp4) is a demo of the functionality..

## Implementation

As in previous homeworks, add your name, your e-mail address, and your UID to the HTML elements at the top. Also make sure your submission generates valid HTML5. Check that it is valid by uploading the DOM content to the [W3C HTML Validator](https://validator.w3.org/) or use a browser extension such as [Validity](https://chrome.google.com/webstore/detail/validity/bbicmjjbohdfglopkidebfccilipgeif?hl=en-GB).


You have the freedom to implement the views how you want, however, we recommend using good web development practices. For example, it is advisable to create at least one javascript file for each view, but you can organize the code however you see fit. We have given you an html file and 2 data files (`words.js` and `words-without-force-positions.csv`). You will be graded on the final appearance and interaction; they should match or improve upon our examples. We will also consider code quality and idiomatic use of D3 and JS for this homework (although we won't judge too harshly, so don't worry). 

## The Data
The data set is a collection of N-grams that are taken from US governors' state of the state addresses. The team at 538 conducted a textual analysis of the resulting N-grams to see what issues were talked about the most and whether there were differences between what Democratic and Republican governors were focusing on. We will be plotting the N-grams along a diverging x-axis to see the differences between words used in Democratic and Republican speeches.

## Part 1. Loading the Data
We have provided one `words.json` file for you that will have all of the data you need to implement. This will be used for both the bubble chart and the table view. 

### (HACKER CHALLENGE) Implement the Simulation

We have provided the `x` and `y` positions generated by a [`d3.force`](https://github.com/d3/d3-force) layout for before and after the group separation. For the hacker version, you will implement your own simulation to get the positions for the bubble chart using the `words-without-force-simulation.csv` data file. We recommend you attempt this mostly for your own learning (the 1 extra point is marginally relevant). However, we also recommend that you start with the data we provided and work on this if you want later. 

You can choose to do the force simulation in a separate function before rendering the bubble chart (saving the positions to your data object), or integrated into your bubble chart. 

To do this, you will need to create a `d3.forceSimulation()`, passing the data to the nodes property of the simulation.

If you are planning to run the simulation before rendering and you are saving the positions, it is helpful to understand that you want to run the tick function of the simulation until it reaches an optimal spacing. A good example of that is from [Mike Bostock](https://bl.ocks.org/mbostock/1667139).

## Part 2: Bubblechart
The bubble chart (beeswarm chart) shows all of the N-grams along a divergent x-axis by percent difference. N-grams used more by democrats appear left of the chart, while those used more by republicans appear on the right. The x and y position for the circles is determined by the `sourceX` and `sourceY` property in the data. The size of the circle encodes the total count which is the `total` property in the data. Circle color encodes the category of the N-gram. You will need to create a size scale and color scale for the circles. The positions are provided for you, or given by the simulation if you attempt the hacker version. For more information on the different kind of scales (and how you can create scales for categorical attributes) refer to the [documentation.](https://github.com/d3/d3-scale).

![Overview](figs/bubblechart.png)

### Part 2A: Toggle between overall and grouped layout
Create a button or toggle (we used a toggle) to separate the beeswarm plot into the N-gram categories. When you click the button or toggle, the groups should be separated in y direction (using position as an encoding for the categories). When you click the toggle again, all circles should return to the one plot. Animate your transitions and make sure you move the points correctly using a key function. The categories to color the circles are the same categories that you use to split up the bubbles. The x and y position for the separated categories are the `moveX` and `moveY` properties in the data.

As an alternative (depending how you are implementing your plot), there is an optional y-position property `correctedY` that allows you to use that with your own y scale if you wish. 

![Table](figs/separate.gif)

### Part 2B: Tooltip for circle hover
You will need to create a tooltip that shows the N-gram, the political difference (`position` in the data), and the total frequency of the N-grams used (needs to be calculated using the `total` divided by 50).

![Table](figs/tooltip.png)

Here is a summary of the things you need for the bubblechart:
* Bubblechart with two states: together and separated by group. Transitions are animated.
* A toggle or button that toggles the separation of the categories.
* The size of the circle encodes the total use of the N-grams.
* The circles are colored by category.
* A diverging x-axis shows the partisan use of each word.
* A tooltip that shows the N-gram, political difference, and total frequency.

## Part 3: Table
The second major view that you will implement is the table. This uses the same data set, however, you should create these headers `Phrase, Frequency, Percentages, and Total`. These will be the columns for your table. The `phrase` in the data is the N-gram. The frequency is the same as that which you have calculated for the tooltip. The percentages column will encode both the republican and democratic percentages for the N-gram. The Total is the `total` property. Two of the four columns should use bar charts as a visual encoding.

When you click on the headers, the table should be sorted by that column. Clicking again should invert the sorting.

You can re-use code from your own previous homework here if you want. 

![Table](figs/table-view.png)


## Part 4. Brushes
Implement brushes for both, the grouped version and the separated version of the bubble plot. By brushing, you update what is seen in the table view. If you click on the bubble plot, the brushes should clear. They should also clear on toggling the grouping. For more information on brushes, see the [documentation on brushes](https://github.com/d3/d3-brush)

Here's how brushes should work:

![Brushes](figs/brushes.gif)

## Part 5. Storytelling
For the example, we highlighted the most extreme terms for both political parties, but you can highlight whatever you find interesting in the data. We recommend that you create a div that will overlay the entire screen that explains something about your data. This will be triggered by a button. It should disappear on mouse click.
 
![highlight](figs/highlight.png)


## Grading

* 10%: Part I (HACKER VERSION EXTRA CREDIT): Data is loaded from the CSV file. JSON file isn't used.   
* 40%: Part II: Bubblechart.  
* 20%: Part III: Table.   
* 25%: Part IV: Brush.
* 15%: Part V: Storytelling.     




